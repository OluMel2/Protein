<%= render "flash_message" %>
<h2>Post detail</h2>
<table class="table">
  <tbody>
    <tr>
      <td>
        <%= link_to @user.name, user_mypage_path(@post.user.id) %>
      </td>
      <td><%= image_tag @post.get_image, width: "100×100" %></td>
      <td><%= @post.product_name %></td>
      <td><%= @post.tag.name %></td>
      <td><%= @post.tast %></td>
      <td>¥<%= @post.price.to_s(:delimited) %>円</td>
      <td><%= @post.net.to_s(:delimited) %>g</td>
      <td><%= @post.serving_size %>g</td>
      <td><%= @post.calorie %>kcal</td>
      <td><%= @post.protein %>g</td>
      <td><%= @post.description %></td>
      <td>
        <% if @post.user == current_user %>
        <%= link_to "Edit", edit_post_path(@post.id), class: "btn btn-sm btn-success" %>
        <% end %>
      </td>
      <td>
        <% if @post.user == current_user %>
        <%= link_to "Destroy", post_path(@post), class: "btn btn-sm btn-danger", method: :delete %>
        <% end %>
      </td>
      <td>
        <div>
          <p>コメント件数：<%= @post.comments.count %></p>
          <% @post.comments.each do |comment| %>
            <p><%= image_tag comment.user.get_profile_image, width: "100×100" %></p>
            <%= link_to comment.user.name, user_mypage_path(comment.user.id) %>
            <%= comment.created_at.strftime('%Y/%m/%d') %><%= comment.comment %>
            <% if comment.user == current_user %>
            <%= link_to "削除", post_comment_path(comment.post, comment), method: :delete %>
            <% end %>
          <% end %>
        </div>
        <div>
          <%= form_with model: [@post, @comment] do |f| %>
            <%= f.text_area :comment, rows: '5', placeholder: "コメントをここに" %>
            <%= f.submit "送信する" %>
          <% end %>
        </div>
      </td>
    </tr>
  </tbody>
</table>